<!DOCTYPE html><html lang="en"><head>

    <link rel="dns-prefetch" href="https://mappingwithd3.com/">
    <link rel="preconnect" href="https://mappingwithd3.com/" crossorigin>
    <title>Projections – Geospatial Data Visualization with d3</title>
    <meta name="description" content="Learn all the things that are important about projections in d3." />

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1">

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Lato:100,300,400,700,900,100italic,300italic,400italic,700italic,900italic|Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Heebo|Titillium+Web&display=swap" rel="stylesheet">
    

    <link rel="preload" href="https://mappingwithd3.com/css/styles.ae953a7f2ba72e3b647034c2bd72282367b511165f4007ceb780cdc7eb959961.css" as="style">
    <link rel="stylesheet" href="https://mappingwithd3.com/css/styles.ae953a7f2ba72e3b647034c2bd72282367b511165f4007ceb780cdc7eb959961.css" >
    <meta property="og:title" content="Projections" />
<meta property="og:description" content="Learn all the things that are important about projections in d3." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mappingwithd3.com/resources/d3/projections/" />
<meta property="article:published_time" content="2019-09-02T23:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2019-09-02T23:00:00&#43;00:00"/><meta property="og:site_name" content="Geospatial Data Visualization with d3" />

    <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://res.cloudinary.com/civicvision/image/upload/v1572533954/geospatial-d3/marketing/website/Mapping_with_d3-3.png"/>

<meta name="twitter:title" content="Projections"/>
<meta name="twitter:description" content="Learn all the things that are important about projections in d3."/>

    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    
      
    

</head>

<script type="text/javascript"> 
  (function(p, a, n, d, o, b) {
     o = n.createElement('script'); o.type = 'text/javascript'; o.async = true; o.src = 'https://tag.rightmessage.com/'+p+'.js';
     b = n.getElementsByTagName('script')[0]; b.parentNode.insertBefore(o, b);
     d = function(h, u, i) { var o = n.createElement('style'); o.id = 'rmcloak'+i; o.type = 'text/css';
             o.appendChild(n.createTextNode('.rmcloak'+h+'{visibility:hidden}.rmcloak'+u+'{display:none}'));
             b.parentNode.insertBefore(o, b); return o; }; o = d('', '-hidden', ''); d('-stay-invisible', '-stay-hidden', '-stay');
     setTimeout(function() { o.parentNode && o.parentNode.removeChild(o); }, a);
  })('1998050406', 2500, document);
  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t,e){var n=document.createElement("script");n.type="text/javascript";n.async=!0;n.src="https://cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(n,a);analytics._loadOptions=e};analytics.SNIPPET_VERSION="4.1.0";
  analytics.load('TQtxpBDBl25APWnGP3NiJSGmH7uSHzZk');
  analytics.page();
  }}();
</script>
<body class="font-light font-sans content post mb-6 text-base md:text-lg leading-relaxed"><div class="w-full bg-blue-darker p-6 bg-hero-topography-blue-lighter-10"><div class="container m-auto max-w-xl flex justify-between md:flex-row"><a class="no-underline text-white font-medium tracking-tight" href="https://mappingwithd3.com/">Geospatial Data Visualization with d3</a><div class="flex"><a class="no-underline text-white font-medium tracking-tight" href="https://mappingwithd3.com//resources">Resources</a></div></div></div><main id="content" role="main"><div class="container m-auto px-8 md:px-4 lg:p-0 md:flex-row max-w-xl">

<h1 id="projections">Projections</h1>

<p>Let&rsquo;s talk about projections!<br />
We need projections to create an actual map.<br />
Geospatial data is usally in the form of <code>latitude</code> and <code>longitude</code> but in the browser we don&rsquo;t have these concepts.<br />
We only have <code>x</code> and <code>y</code> coordinates.</p>

<blockquote>
<p><strong>Goal:</strong> Our goal is to transform geo-coordinates to screen-coordinates.</p>
</blockquote>

<p>Projections are just math. And what they do is transform latitude and longitude coordinates to x and y coordinates on a flat surface (e.g. your screen).<br />
Learn more about projections <a href="https://www.axismaps.com/guide/general/map-projections/">here</a>.</p>

<p>And if you want to dive into the math, go over <a href="http://mathworld.wolfram.com/Projection.html">here</a>.</p>

<h2 id="let-s-define-our-first-projection">Let&rsquo;s define our first projection:</h2>

<p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">projection</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">d3</span>.<span style="color:#a6e22e">geoNaturalEarth1</span>();
</code></pre></div>
Easy, right? In d3 these are functions we can call with an array of coordinates.<br />
<code>projection([3.4, 52.3]</code> One important thing to remember is that in d3 we call projections with <code>**[longitude,latitude]**</code>. Read more about the way different libraries handle it <a href="https://macwright.org/lonlat/">here</a>.<br />
The result of this call is an array of x,y coordinates. E.g.:<br />
<code>[300,400]</code> or <code>[x,y]</code></p>

<p>We got some X, Y coordinates as output, but theres something missing: the projection has no knowledge of the size or extent of our SVG element. If we don‘t provide more information to the projection function you won‘t see a thing on the screen. Because the defaults for projections are:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">center</span> <span style="color:#f92672">=</span> <span style="color:#960050;background-color:#1e0010">\</span>[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span><span style="color:#960050;background-color:#1e0010">\</span>]
<span style="color:#a6e22e">transform</span> <span style="color:#f92672">=</span> <span style="color:#960050;background-color:#1e0010">\</span>[<span style="color:#ae81ff">480</span>,<span style="color:#ae81ff">250</span><span style="color:#960050;background-color:#1e0010">\</span>]
</code></pre></div>

<p>The center of the map would be somewhere in the ocean near Africa (the 0,0 coordinate) and would only work if your element is 960x500 pixels.</p>

<p>We can change these defaults with the methods <code>scale</code> <code>center</code> and <code>translate</code></p>

<p>The most important for us right now are <code>center</code> and <code>translate</code>. With <code>center</code> we set the center of the projection. So the point we want to be the center of our SVG.<br />
„The translation offset determines the pixel coordinates of the projection’s center“ (<a href="https://github.com/d3/d3-geo#projections">D3 Documentation</a>).<br />
Or in other words we set the translation offset to half of the width and height of our svg. So that the center of our SVG element (half of width and half of height = center of the svg) corresponds to the center of the projection.</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">projection</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">d3</span>.<span style="color:#a6e22e">geoNaturalEarth1</span>();
<span style="color:#a6e22e">projection</span>.<span style="color:#a6e22e">center</span>(<span style="color:#960050;background-color:#1e0010">\</span>[<span style="color:#ae81ff">3.4</span>, <span style="color:#ae81ff">52.3</span><span style="color:#960050;background-color:#1e0010">\</span>])
.<span style="color:#a6e22e">translate</span>(<span style="color:#960050;background-color:#1e0010">\</span>[<span style="color:#ae81ff">200</span>,<span style="color:#ae81ff">200</span><span style="color:#960050;background-color:#1e0010">\</span>]);
</code></pre></div>

<p>With these parameters we change the &ldquo;position&rdquo; of the map.</p>

<p>D3 comes with a long list of projections, you will find them <a href="https://github.com/d3/d3-geo/blob/master/README.md#azimuthal-projections">here</a>.</p>
<div class="rm-after-resource-article"></div><h3>See Also</h3><div class="flex flex-col md:flex-row"><div class="text-xl md:mr-4 bg-blue-darker p-4 md:w-1/3 mb-4"><h4 class="mb-2"><a class="text-white" href="/resources/d3/tooltip/">How to create a simple tooltip in d3.js</a></h4><p class="text-white">Learn how to create tooltips in d3. This post shows you actual d3 code and adds explanations to the most important aspects of tooltips in d3 and has a demo as well. </p></div><div class="text-xl md:mr-4 bg-blue-darker p-4 md:w-1/3 mb-4"><h4 class="mb-2"><a class="text-white" href="/resources/d3/svg-basics/">SVG Basics for d3</a></h4><p class="text-white">Three basic elements of SVG you should know if you want to create maps with d3. </p></div></div></div></main><div id="tooltip" class="bg-white p-2 border">
  <div class="text-center" id="small-map"></div>
  <div class="text-xl text-center border-b" id="community"></div>
  <div class="flex mt-2">
    <div class="w-1/2 ">
      <div class="text-gray-600 text-xs">30% of income</div>
      <div class="font-bold text-black" id="percentage-30">100</div>
    </div>
    <div class="w-1/2">
      <div class="text-gray-600 text-xs">50% of income</div>
      <div class="font-bold text-black" id="percentage-50">100</div>
    </div>
  </div>
</div>
<style>
  #tooltip {
    width: 250px;
    opacity: 0;
  }
</style>
<script src="https://d3js.org/d3.v5.min.js"></script>
<script src="/javascript/housing-map.js"></script>
<script type="text/javascript">
  if(document.querySelector('#housing-map-parent')) {
    chart();
  }
</script>
<div class="footer">
  <div class="w-full bg-blue-darker p-6 bg-hero-topography-blue-lighter-10"><div class="container m-auto max-w-xl flex justify-between flex-col"><a class="no-underline text-white font-medium tracking-tight" href="https://mappingwithd3.com//resources">Resources</a><a class="no-underline text-white font-medium tracking-tight" href="http://milafrerichs.de">Instructor's Homepage</a></div></div>
</div>
<script type="text/javascript" data-cfasync="false">function SendUrlToDeadlineFunnel(e){var r,t,c,a,h,n,o,A,i = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=0,l=0,s="",u=[];if(!e)return e;do r=e.charCodeAt(d++),t=e.charCodeAt(d++),c=e.charCodeAt(d++),A=r<<16|t<<8|c,a=A>>18&63,h=A>>12&63,n=A>>6&63,o=63&A,u[l++]=i.charAt(a)+i.charAt(h)+i.charAt(n)+i.charAt(o);while(d<e.length);s=u.join("");var C=e.length%3;var decoded = (C?s.slice(0,C-3):s)+"===".slice(C||3);decoded = decoded.replace("+", "-");decoded = decoded.replace("/", "_");return decoded;} var url = SendUrlToDeadlineFunnel(location.href); var parentUrlValue;try {parentUrlValue = window.parent.location.href;} catch(err) {if(err.name === "SecurityError") {parentUrlValue = document.referrer;}}var parentUrl = (parent !== window) ? ("/" + SendUrlToDeadlineFunnel(parentUrlValue)) : "";(function() {var s = document.createElement("script");s.type = "text/javascript";s.async = true;s.setAttribute("data-scriptid", "dfunifiedcode");s.src ="https://a.deadlinefunnel.com/unified/reactunified.bundle.js?userIdHash=eyJpdiI6IkhxeGFDRXJCdUFxWDNlVFNwa1JNVEE9PSIsInZhbHVlIjoiZWVMN1FTXC9JR01nMzhvZ0h5NXFUSGc9PSIsIm1hYyI6ImVjYTA4OTc4ZTA1YTQ1YTk5ZDliYTVlM2M1YjA0M2ViZWE5NTY4YTkxNjExODk5MjdkMjZkYzdiYTRjNGI5ZDYifQ==&pageFromUrl="+url+"&parentPageFromUrl="+parentUrl;var s2 = document.getElementsByTagName("script")[0];s2.parentNode.insertBefore(s, s2);})();</script>
<div class="modal"></div>
  


  

</body></html>