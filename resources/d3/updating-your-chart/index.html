<!DOCTYPE html><html lang="en"><head>

    <link rel="dns-prefetch" href="https://mappingwithd3.com/">
    <link rel="preconnect" href="https://mappingwithd3.com/" crossorigin>
    <title>Updating your chart in d3.js – Geospatial Data Visualization with d3</title>
    <meta name="description" content="How v5 helps clean up your updating code" />

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1">

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Lato:100,300,400,700,900,100italic,300italic,400italic,700italic,900italic|Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Heebo|Titillium+Web&display=swap" rel="stylesheet">
    

    <link rel="preload" href="https://mappingwithd3.com/css/styles.ae953a7f2ba72e3b647034c2bd72282367b511165f4007ceb780cdc7eb959961.css" as="style">
    <link rel="stylesheet" href="https://mappingwithd3.com/css/styles.ae953a7f2ba72e3b647034c2bd72282367b511165f4007ceb780cdc7eb959961.css" >
    <meta property="og:title" content="Updating your chart in d3.js" />
<meta property="og:description" content="How v5 helps clean up your updating code" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mappingwithd3.com/resources/d3/updating-your-chart/" />
<meta property="article:published_time" content="2019-09-03T02:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2019-09-03T02:00:00&#43;00:00"/><meta property="og:site_name" content="Geospatial Data Visualization with d3" />

    <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://res.cloudinary.com/civicvision/image/upload/f_auto,q_auto,w_auto,dpr_auto,c_limit/geospatial-d3/marketing/website/housing-burden-chicago-t.png"/>

<meta name="twitter:title" content="Updating your chart in d3.js"/>
<meta name="twitter:description" content="How v5 helps clean up your updating code"/>

    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    
      
    

</head>

<script type="text/javascript"> 
  (function(p, a, n, d, o, b) {
     o = n.createElement('script'); o.type = 'text/javascript'; o.async = true; o.src = 'https://tag.rightmessage.com/'+p+'.js';
     b = n.getElementsByTagName('script')[0]; b.parentNode.insertBefore(o, b);
     d = function(h, u, i) { var o = n.createElement('style'); o.id = 'rmcloak'+i; o.type = 'text/css';
             o.appendChild(n.createTextNode('.rmcloak'+h+'{visibility:hidden}.rmcloak'+u+'{display:none}'));
             b.parentNode.insertBefore(o, b); return o; }; o = d('', '-hidden', ''); d('-stay-invisible', '-stay-hidden', '-stay');
     setTimeout(function() { o.parentNode && o.parentNode.removeChild(o); }, a);
  })('1998050406', 2500, document);
  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t,e){var n=document.createElement("script");n.type="text/javascript";n.async=!0;n.src="https://cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(n,a);analytics._loadOptions=e};analytics.SNIPPET_VERSION="4.1.0";
  analytics.load('TQtxpBDBl25APWnGP3NiJSGmH7uSHzZk');
  analytics.page();
  }}();
</script>
<body class="font-light font-sans content post mb-6 text-base md:text-lg leading-relaxed"><div class="w-full bg-blue-darker p-6 bg-hero-topography-blue-lighter-10"><div class="container m-auto max-w-xl flex justify-between md:flex-row"><a class="no-underline text-white font-medium tracking-tight" href="https://mappingwithd3.com/">Geospatial Data Visualization with d3</a><div class="flex"><a class="no-underline text-white font-medium tracking-tight" href="https://mappingwithd3.com//resources">Resources</a></div></div></div><main id="content" role="main"><div class="container m-auto px-8 md:px-4 lg:p-0 md:flex-row max-w-xl">

<h1 id="updating-your-chart">Updating your chart</h1>

<p>Updating your d3 chart used to be a bit confusing for most people.</p>

<p>The data pattern takes some time to understand properly and when I teach d3 courses people always got trip up on it.</p>

<p>But d3 version 5 just made it a <strong>whole lot easier</strong> to use and understand.</p>

<p>There is a new method: <code>join</code>
And with it we don&rsquo;t need to use <code>enter</code> and <code>exit</code> directly anymore. These were the methods with the most confusion.</p>

<p>But you still can use them. You pass them to the <code>join</code> method to have more fine grain control.</p>

<p>Let‘s take a look at how it works.</p>

<h2 id="before">Before:</h2>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">circles</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">d3</span>.<span style="color:#a6e22e">select</span>(<span style="color:#e6db74">&#39;svg&#39;</span>).<span style="color:#a6e22e">selectAll</span>(<span style="color:#e6db74">&#39;circle&#39;</span>).<span style="color:#a6e22e">data</span>([<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>])
<span style="color:#a6e22e">circles</span>.<span style="color:#a6e22e">enter</span>().<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#39;circle&#39;</span>)
<span style="color:#a6e22e">circles</span>.<span style="color:#a6e22e">exit</span>().<span style="color:#a6e22e">remove</span>()
<span style="color:#a6e22e">circles</span>.<span style="color:#a6e22e">merge</span>().<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#39;r&#39;</span>, (<span style="color:#a6e22e">d</span>) =&gt; <span style="color:#a6e22e">d</span>)
</code></pre></div>

<h2 id="after">After</h2>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">circles</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">d3</span>.<span style="color:#a6e22e">select</span>(<span style="color:#e6db74">&#39;svg&#39;</span>).<span style="color:#a6e22e">selectAll</span>(<span style="color:#e6db74">&#39;circle&#39;</span>).<span style="color:#a6e22e">data</span>([<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>])
<span style="color:#a6e22e">circles</span>.<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#39;circle&#39;</span>).<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#39;r&#39;</span>, (<span style="color:#a6e22e">d</span>) =&gt; <span style="color:#a6e22e">d</span>)
</code></pre></div>

<p><strong>What?</strong> Pretty great, right?
That means less boilerplate code. I used to write the <em>enter, append, exit, remove</em> code a lot of times. So it‘s great that this is now gone. The  <code>join</code> method will call <code>append</code> and <code>remove</code> internally.</p>

<p>But what if you want to animate the remove?
You still can. It‘s just a little different:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">circles</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">d3</span>.<span style="color:#a6e22e">select</span>(<span style="color:#e6db74">&#39;svg&#39;</span>).<span style="color:#a6e22e">selectAll</span>(<span style="color:#e6db74">&#39;circle&#39;</span>).<span style="color:#a6e22e">data</span>([<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>])
<span style="color:#a6e22e">circles</span>.<span style="color:#a6e22e">join</span>(
  <span style="color:#a6e22e">enter</span> =&gt;   
    <span style="color:#a6e22e">enter</span>.<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#39;circle&#39;</span>).<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#39;fill&#39;</span>, <span style="color:#e6db74">&#39;green&#39;</span>),   
  <span style="color:#a6e22e">exit</span> =&gt; <span style="color:#a6e22e">exit</span>.<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#39;fill&#39;</span>, <span style="color:#e6db74">&#39;brown&#39;</span>).<span style="color:#a6e22e">call</span>(
    <span style="color:#a6e22e">exit</span> =&gt;   
      <span style="color:#a6e22e">exit</span>.<span style="color:#a6e22e">transition</span>(<span style="color:#a6e22e">svg</span>.<span style="color:#a6e22e">transition</span>().<span style="color:#a6e22e">duration</span>(<span style="color:#ae81ff">750</span>))
    .<span style="color:#a6e22e">remove</span>()
    )
)
</code></pre></div></p>

<p>This looks a little crazy. But is kinda genius. The uses-cases for these animations and changes are rare, so most people will benefit greatly from this change and the others just need to learn a little bit different syntax.</p>
<div class="rm-after-resource-article"></div><h3>See Also</h3><div class="flex flex-col md:flex-row"><div class="text-xl md:mr-4 bg-blue-darker p-4 md:w-1/3 mb-4"><h4 class="mb-2"><a class="text-white" href="/resources/d3/projections/">Projections</a></h4><p class="text-white">Learn all the things that are important about projections in d3.</p></div><div class="text-xl md:mr-4 bg-blue-darker p-4 md:w-1/3 mb-4"><h4 class="mb-2"><a class="text-white" href="/resources/d3/tooltip/">How to create a simple tooltip in d3.js</a></h4><p class="text-white">Learn how to create tooltips in d3. This post shows you actual d3 code and adds explanations to the most important aspects of tooltips in d3 and has a demo as well. </p></div><div class="text-xl md:mr-4 bg-blue-darker p-4 md:w-1/3 mb-4"><h4 class="mb-2"><a class="text-white" href="/resources/d3/svg-basics/">SVG Basics for d3</a></h4><p class="text-white">Three basic elements of SVG you should know if you want to create maps with d3. </p></div></div></div></main><div id="tooltip" class="bg-white p-2 border">
  <div class="text-center" id="small-map"></div>
  <div class="text-xl text-center border-b" id="community"></div>
  <div class="flex mt-2">
    <div class="w-1/2 ">
      <div class="text-gray-600 text-xs">30% of income</div>
      <div class="font-bold text-black" id="percentage-30">100</div>
    </div>
    <div class="w-1/2">
      <div class="text-gray-600 text-xs">50% of income</div>
      <div class="font-bold text-black" id="percentage-50">100</div>
    </div>
  </div>
</div>
<style>
  #tooltip {
    width: 250px;
    opacity: 0;
  }
</style>
<script src="https://d3js.org/d3.v5.min.js"></script>
<script src="/javascript/housing-map.js"></script>
<script type="text/javascript">
  if(document.querySelector('#housing-map-parent')) {
    chart();
  }
</script>
<div class="footer">
  <div class="w-full bg-blue-darker p-6 bg-hero-topography-blue-lighter-10"><div class="container m-auto max-w-xl flex justify-between flex-col"><a class="no-underline text-white font-medium tracking-tight" href="https://mappingwithd3.com//resources">Resources</a><a class="no-underline text-white font-medium tracking-tight" href="http://milafrerichs.de">Instructor's Homepage</a></div></div>
</div>
<div class="modal"></div>
  


  

</body></html>